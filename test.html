<!DOCTYPE html>
<meta charset="utf-8">
<html>
<body>
<canvas id="canvas" width="1980" height="1080" style="position:fixed;top:0px;left:0px;width:100vw;height:100vh;background:#222222;color:#ffffff;">
Canvas not supported
</canvas>
<input style="position:relative;z-index:1;background:#00000000;color:#ffffff;" type="text" id="input" contenteditable="true"/>
</body>
<script type="text/javascript" charset="UTF-8" src="./color.js"></script>
<script type="text/javascript" charset="UTF-8" src="./mexpr.js"></script>
<script>
const c=document.getElementById("canvas");
const ctx=c.getContext("2d");
ctx.font="20pt math";
ctx.strokeStyle="#ff0000";
ctx.fillStyle="#ffffff";

const iField = document.getElementById("input");
iField.addEventListener("keyup", function(event) {
    if (event.key === "Enter") {
        eq=stringToElement(iField.value);
        redraw();
    }
});
if(!iField.value)
  iField.value="{{-b\\pm \\sqrt {bÂ²-4 a c}}/{2 a}}";

let eq=stringToElement("\\pi=3+1 / { 7 + (1/ { 15 +1 / { 1 + 1/{292+1 /... }}})}");
function redraw(){
  ctx.clearRect(0,0,c.width,c.height);
  measureMathElement(ctx,eq);
  let x0=-(eq.outerBox.x0+eq.outerBox.x1)/2-eq.x;
  let y0=-(eq.outerBox.y0+eq.outerBox.y1)/2-eq.y;
  drawMathElement(ctx,eq,x0+c.width/2,y0+c.height/2);
}
redraw();
</script>
</html>
